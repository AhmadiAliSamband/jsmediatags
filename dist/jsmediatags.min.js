(function(t){"object"===typeof exports&&"undefined"!==typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).jsmediatags=t()})(function(){return function f(m,n,l){function g(a,b){if(!n[a]){if(!m[a]){var e="function"==typeof require&&require;if(!b&&e)return e(a,!0);if(d)return d(a,!0);e=Error("Cannot find module '"+a+"'");throw e.code="MODULE_NOT_FOUND",e;}e=n[a]=
{exports:{}};m[a][0].call(e.exports,function(b){var e=m[a][1][b];return g(e?e:b)},e,e.exports,f,m,n,l)}return n[a].exports}for(var d="function"==typeof require&&require,a=0;a<l.length;a++)g(l[a]);return g}({1:[function(f,m,n){},{}],2:[function(f,m,n){m.exports=XMLHttpRequest},{}],3:[function(f,m,n){var l=function(){function g(d,a){for(var c=0;c<a.length;c++){var b=a[c];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(d,b.key,b)}}return function(d,
a,c){a&&g(d.prototype,a);c&&g(d,c);return d}}();f("./FlowTypes");f=function(){function g(){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");this._fileData=[]}l(g,null,[{key:"NOT_FOUND",get:function(){return-1}}]);l(g,[{key:"addData",value:function(d,a){var c=d+a.length-1,b=this._getChunkRange(d,c);if(-1===b.startIx)this._fileData.splice(b.insertIx||0,0,{offset:d,data:a});else{var e=this._fileData[b.startIx],h=this._fileData[b.endIx],c=c<h.offset+h.data.length,k={offset:Math.min(d,
e.offset),data:a};d>e.offset&&(k.data=e.data.slice(0,d-e.offset).concat(a));c&&(k.data=a.slice(0,h.offset-d).concat(h.data));this._fileData.splice(b.startIx,b.endIx-b.startIx+1,k)}}},{key:"_getChunkRange",value:function(d,a){for(var c=-1,b=-1,e=0,h=0;h<this._fileData.length;h++,e=h){var k=this._fileData[h].offset,r=k+this._fileData[h].data.length;if(a<k-1)break;if(d<=r+1&&a>=k-1){c=h;break}}if(-1===c)return{startIx:-1,endIx:-1,insertIx:e};for(h=c;h<this._fileData.length&&!(k=this._fileData[h].offset,
r=k+this._fileData[h].data.length,a>=k-1&&(b=h),a<=r+1);h++);-1===b&&(b=c);return{startIx:c,endIx:b}}},{key:"hasDataRange",value:function(d,a){for(var c=0;c<this._fileData.length;c++){var b=this._fileData[c];if(a<b.offset)break;if(d>=b.offset&&a<b.offset+b.data.length)return!0}return!1}},{key:"getByteAt",value:function(d){for(var a,c=0;c<this._fileData.length;c++)if(d>=this._fileData[c].offset){a=this._fileData[c];break}if(a&&(c=d-a.offset,c<a.data.length))return a.data[c];throw Error("Offset "+d+
" hasn't been loaded yet.");}}]);return g}();m.exports=f},{"./FlowTypes":4}],4:[function(f,m,n){f("./MediaFileReader")},{"./MediaFileReader":7}],5:[function(f,m,n){function l(a){var c;switch(a){case 0:c="iso-8859-1";break;case 1:c="utf-16";break;case 2:c="utf-16be";break;case 3:c="utf-8"}return c}f("./FlowTypes");f("./MediaFileReader");var g={APIC:function(a,c,b,e,h){h=h||"3";e=a;var k=l(b.getByteAt(a));switch(h){case "2":var r=b.getStringAt(a+1,3);a+=4;break;case "3":case "4":r=b.getStringWithCharsetAt(a+
1,c-(a-e)),a+=1+r.bytesReadCount}h=b.getByteAt(a,1);h=d[h];k=b.getStringWithCharsetAt(a+1,c-(a-e),k);a+=1+k.bytesReadCount;return{format:r.toString(),type:h,description:k.toString(),data:b.getBytesAt(a,e+c-a)}},COMM:function(a,c,b,e,h){var k=a,d=l(b.getByteAt(a));e=b.getStringAt(a+1,3);h=b.getStringWithCharsetAt(a+4,c-4,d);a+=4+h.bytesReadCount;a=b.getStringWithCharsetAt(a,k+c-a,d);return{language:e,short_description:h.toString(),text:a.toString()}}};g.COM=g.COMM;g.PIC=function(a,c,b,e,h){return g.APIC(a,
c,b,e,"2")};g.PCNT=function(a,c,b,e,h){return b.getLongAt(a,!1)};g.CNT=g.PCNT;g["T*"]=function(a,c,b,e,h){e=l(b.getByteAt(a));return b.getStringWithCharsetAt(a+1,c-1,e).toString()};g.TCON=function(a,c,b,e){return g["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")};g.TCO=g.TCON;g.USLT=function(a,c,b,e,h){var k=a,d=l(b.getByteAt(a));e=b.getStringAt(a+1,3);h=b.getStringWithCharsetAt(a+4,c-4,d);a+=4+h.bytesReadCount;a=b.getStringWithCharsetAt(a,k+c-a,d);return{language:e,descriptor:h.toString(),lyrics:a.toString()}};
g.ULT=g.USLT;var d="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");m.exports={getFrameReaderFunction:function(a){return a in g?g[a]:"T"===
a[0]?g["T*"]:null}}},{"./FlowTypes":4,"./MediaFileReader":7}],6:[function(f,m,n){function l(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var g=function(){function a(b,c){for(var k=0;k<c.length;k++){var d=c[k];d.enumerable=d.enumerable||!1;d.configurable=
!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(c,h,k){h&&a(c.prototype,h);k&&a(c,k);return c}}();f("./FlowTypes");n=f("./MediaTagReader");f("./MediaFileReader");var d=f("./ID3v2FrameReader");f=function(b){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var a=Object.getPrototypeOf(e).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==
typeof a&&"function"!==typeof a?this:a}l(e,b);g(e,[{key:"_loadData",value:function(a,b){a.loadRange([6,9],{onSuccess:function(){a.loadRange([0,a.getSynchsafeInteger32At(6)],b)},onError:b.onError})}},{key:"_parseData",value:function(a,b){var e=0,d=a.getByteAt(e+3);if(4<d)return{version:">2.4"};var g=a.getByteAt(e+4),f=a.isBitSetAt(e+5,7),m=a.isBitSetAt(e+5,6),l=a.isBitSetAt(e+5,5),n=a.getSynchsafeInteger32At(e+6),e=e+10;if(m)var q=a.getLongAt(e,!0),e=e+(q+4);var d={version:"2."+d+"."+g,major:d,revision:g,
flags:{unsynchronisation:f,extended_header:m,experimental_indicator:l,footer_present:!1},size:n,tags:{}},e=f?{}:this._readFrames(e,n-10,a,d,b),p;for(p in c)c.hasOwnProperty(p)&&(f=this._getFrameData(e,c[p]))&&(d.tags[p]=f);for(var u in e)e.hasOwnProperty(u)&&(d.tags[u]=e[u]);return d}},{key:"_readFrames",value:function(a,b,c,e,g){var f={};for(g&&(g=this._expandShortcutTags(g));a<b;){var m=this._readFrameHeader(c,a,e),l=m.id;if(0===m.size)break;if(!l)break;var n=m.flags,q=m.size,p=a+m.headerSize;a+=
m.headerSize+m.size;g&&-1===g.indexOf(l)||n&&n.format.unsynchronisation||(n&&n.format.data_length_indicator&&(p+=4,q-=4),n=(m=d.getFrameReaderFunction(l))?m(p,q,c,n):null,p=this._getFrameDescription(l),q={id:l,size:q,description:p,data:n},l in f?(f[l].id&&(f[l]=[f[l]]),f[l].push(q)):f[l]=q)}return f}},{key:"_readFrameHeader",value:function(a,b,c){c=c.major;var e=null;switch(c){case 2:var d=a.getStringAt(b,3),g=a.getInteger24At(b+3,!0),f=6;break;case 3:d=a.getStringAt(b,4);g=a.getLongAt(b+4,!0);f=
10;break;case 4:d=a.getStringAt(b,4),g=a.getSynchsafeInteger32At(b+4),f=10}d&&2<c&&(e=this._readFrameFlags(a,b+8));return{id:d,size:g,headerSize:f,flags:e}}},{key:"_readFrameFlags",value:function(a,b){return{message:{tag_alter_preservation:a.isBitSetAt(b,6),file_alter_preservation:a.isBitSetAt(b,5),read_only:a.isBitSetAt(b,4)},format:{grouping_identity:a.isBitSetAt(b+1,7),compression:a.isBitSetAt(b+1,3),encryption:a.isBitSetAt(b+1,2),unsynchronisation:a.isBitSetAt(b+1,1),data_length_indicator:a.isBitSetAt(b+
1,0)}}}},{key:"_getFrameData",value:function(a,b){for(var c=0,e;e=b[c];c++)if(e in a)return a[e].data}},{key:"_getFrameDescription",value:function(b){return b in a?a[b]:"Unknown"}},{key:"_expandShortcutTags",value:function(a){for(var b=[],e=0,d;d=a[e];e++)b=b.concat(c[d]||[d]);return b}}],[{key:"getTagIdentifierByteRange",value:function(){return[0,9]}},{key:"canReadTagFormat",value:function(a){return"ID3"===String.fromCharCode.apply(String,a.slice(0,3))}}]);return e}(n);var a={BUF:"Recommended buffer size",
CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",
TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",
TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",
WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",
IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",
TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",
TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",
TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",
WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"},c={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};m.exports=f},{"./FlowTypes":4,"./ID3v2FrameReader":5,"./MediaFileReader":7,"./MediaTagReader":8}],7:[function(f,m,n){var l=function(){function d(a,
c){for(var b=0;b<c.length;b++){var e=c[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,b){c&&d(a.prototype,c);b&&d(a,b);return a}}();f("./StringUtils");f("./FlowTypes");var g=f("./StringUtils");f=function(){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._isInitialized=!1;this._size=0}l(d,[{key:"init",value:function(a){throw Error("Must implement init function");
}},{key:"loadRange",value:function(a,c){throw Error("Must implement loadRange function");}},{key:"getSize",value:function(){if(!this._isInitialized)throw Error("init() must be called first.");return this._size}},{key:"getByteAt",value:function(a){throw Error("Must implement getByteAt function");}},{key:"getBytesAt",value:function(a,c){for(var b=Array(c),e=0;e<c;e++)b[e]=this.getByteAt(a+e);return b}},{key:"isBitSetAt",value:function(a,c){return 0!=(this.getByteAt(a)&1<<c)}},{key:"getSByteAt",value:function(a){a=
this.getByteAt(a);return 127<a?a-256:a}},{key:"getShortAt",value:function(a,c){var b=c?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a);0>b&&(b+=65536);return b}},{key:"getSShortAt",value:function(a,c){var b=this.getShortAt(a,c);return 32767<b?b-65536:b}},{key:"getLongAt",value:function(a,c){var b=this.getByteAt(a),e=this.getByteAt(a+1),d=this.getByteAt(a+2),k=this.getByteAt(a+3),b=c?(((b<<8)+e<<8)+d<<8)+k:(((k<<8)+d<<8)+e<<8)+b;0>b&&(b+=4294967296);return b}},
{key:"getSLongAt",value:function(a,c){var b=this.getLongAt(a,c);return 2147483647<b?b-4294967296:b}},{key:"getInteger24At",value:function(a,c){var b=this.getByteAt(a),e=this.getByteAt(a+1),d=this.getByteAt(a+2),b=c?((b<<8)+e<<8)+d:((d<<8)+e<<8)+b;0>b&&(b+=16777216);return b}},{key:"getStringAt",value:function(a,c){for(var b=[],e=a,d=0;e<a+c;e++,d++)b[d]=String.fromCharCode(this.getByteAt(e));return b.join("")}},{key:"getStringWithCharsetAt",value:function(a,c,b){a=this.getBytesAt(a,c);switch((b||
"").toLowerCase()){case "utf-16":case "utf-16le":case "utf-16be":b=g.readUTF16String(a,"utf-16be"===b);break;case "utf-8":b=g.readUTF8String(a);break;default:b=g.readNullTerminatedString(a)}return b}},{key:"getCharAt",value:function(a){return String.fromCharCode(this.getByteAt(a))}},{key:"getSynchsafeInteger32At",value:function(a){var c=this.getByteAt(a),b=this.getByteAt(a+1),e=this.getByteAt(a+2);return this.getByteAt(a+3)&127|(e&127)<<7|(b&127)<<14|(c&127)<<21}}],[{key:"canReadFile",value:function(a){throw Error("Must implement canReadFile function");
}}]);return d}();m.exports=f},{"./FlowTypes":4,"./StringUtils":9}],8:[function(f,m,n){var l=function(){function g(d,a){for(var c=0;c<a.length;c++){var b=a[c];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(d,b.key,b)}}return function(d,a,c){a&&g(d.prototype,a);c&&g(d,c);return d}}();f("./FlowTypes");f("./MediaFileReader");f=function(){function g(d){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");this._mediaFileReader=
d;this._tags=null}l(g,[{key:"setTags",value:function(d){this._tags=d;return this}},{key:"read",value:function(d){var a=this;this._mediaFileReader.init({onSuccess:function(){a._loadData(a._mediaFileReader,{onSuccess:function(){var c=a._parseData(a._mediaFileReader,a._tags);d.onSuccess(c)},onError:d.onError})},onError:d.onError})}},{key:"_loadData",value:function(d,a){throw Error("Must implement _loadData function");}},{key:"_parseData",value:function(d,a){throw Error("Must implement _parseData function");
}}],[{key:"getTagIdentifierByteRange",value:function(){throw Error("Must implement");}},{key:"canReadTagFormat",value:function(d){throw Error("Must implement");}}]);return g}();m.exports=f},{"./FlowTypes":4,"./MediaFileReader":7}],9:[function(f,m,n){var l=function(){function d(a,c){for(var b=0;b<c.length;b++){var e=c[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,b){c&&d(a.prototype,c);b&&d(a,b);return a}}(),g=
function(){function d(a,c){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this._value=a;this.bytesReadCount=c;this.length=a.length}l(d,[{key:"toString",value:function(){return this._value}}]);return d}();m.exports={readUTF16String:function(d,a,c){var b=0,e=1,h=0;c=Math.min(c||d.length,d.length);254==d[0]&&255==d[1]?(a=!0,b=2):255==d[0]&&254==d[1]&&(a=!1,b=2);a&&(e=0,h=1);a=[];for(var k=0;b<c;k++){var f=d[b+e],l=(f<<8)+d[b+h],b=b+2;if(0==l)break;else 216>f||224<=f?
a[k]=String.fromCharCode(l):(f=(d[b+e]<<8)+d[b+h],b+=2,a[k]=String.fromCharCode(l,f))}return new g(a.join(""),b)},readUTF8String:function(d,a){var c=0;a=Math.min(a||d.length,d.length);239==d[0]&&187==d[1]&&191==d[2]&&(c=3);for(var b=[],e=0;c<a;e++){var h=d[c++];if(0==h)break;else if(128>h)b[e]=String.fromCharCode(h);else if(194<=h&&224>h){var k=d[c++];b[e]=String.fromCharCode(((h&31)<<6)+(k&63))}else if(224<=h&&240>h){var k=d[c++],f=d[c++];b[e]=String.fromCharCode(((h&255)<<12)+((k&63)<<6)+(f&63))}else if(240<=
h&&245>h){var k=d[c++],f=d[c++],l=d[c++],h=((h&7)<<18)+((k&63)<<12)+((f&63)<<6)+(l&63)-65536;b[e]=String.fromCharCode((h>>10)+55296,(h&1023)+56320)}}return new g(b.join(""),c)},readNullTerminatedString:function(d,a){var c=[];a=a||d.length;for(var b=0;b<a;){var e=d[b++];if(0==e)break;c[b-1]=String.fromCharCode(e)}return new g(c.join(""),b)}}},{}],10:[function(f,m,n){function l(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);
a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var g=function(){function a(a,b){for(var e=0;e<b.length;e++){var d=b[e];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,e){b&&a(c.prototype,b);e&&a(c,e);return c}}();f("./FlowTypes");var d=f("./ChunkedFileData");n=function(a){function c(a){if(!(this instanceof
c))throw new TypeError("Cannot call a class as a function");var e;e=Object.getPrototypeOf(c).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e._url=a;e._fileData=new d;return e}l(c,a);g(c,[{key:"init",value:function(a){var c=this;this._makeXHRRequest("HEAD",null,{onSuccess:function(d){c._size=parseInt(d.getResponseHeader("Content-Length"),10);c._isInitialized=!0;a.onSuccess()},onError:a.onError})}},
{key:"loadRange",value:function(a,c){var d=this;this._makeXHRRequest("GET",a,{onSuccess:function(k){d._fileData.addData(a[0],k.responseBody||k.responseText);c.onSuccess()},onError:c.onError})}},{key:"_makeXHRRequest",value:function(a,c,d){var k=this._createXHRObject(),f=function(){if(200===k.status||206===k.status)d.onSuccess(k);else if(d.onError)d.onError({type:"xhr",xhr:k});k=null};"undefined"!==typeof k.onload?(k.onload=f,k.onerror=function(){if(d.onError)d.onError({type:"xhr",xhr:k})}):k.onreadystatechange=
function(){4===k.readyState&&f()};k.open(a,this._url);k.overrideMimeType("text/plain; charset=x-user-defined");c&&k.setRequestHeader("Range","bytes="+c[0]+"-"+c[1]);k.setRequestHeader("If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT");k.send(null)}},{key:"getByteAt",value:function(a){return this._fileData.getByteAt(a).charCodeAt(0)&255}},{key:"_createXHRObject",value:function(){if("undefined"===typeof window)return new (f("xhr2").XMLHttpRequest);if(window.XMLHttpRequest)return new window.XMLHttpRequest;
throw Error("XMLHttpRequest is not supported");}}],[{key:"canReadFile",value:function(a){return"string"===typeof a&&/^[a-z]+:\/\//i.test(a)}}]);return c}(f("./MediaFileReader"));m.exports=n},{"./ChunkedFileData":3,"./FlowTypes":4,"./MediaFileReader":7,xhr2:2}],11:[function(f,m,n){function l(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}var g=function(){function a(b,c){for(var d=0;d<c.length;d++){var e=c[d];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in
e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();f("./FlowTypes");f("./MediaFileReader");n=f("./NodeFileReader");var d=f("./XhrFileReader");f("./MediaTagReader");f=f("./ID3v2TagReader");var a=[],c=[],b=function(){function b(a){l(this,b);this._file=a}g(b,[{key:"setTags",value:function(a){this._tags=a;return this}},{key:"setFileReader",value:function(a){this._fileReader=a;return this}},{key:"setTagReader",value:function(a){this._tagReader=
a;return this}},{key:"read",value:function(a){var b=new (this._getFileReader())(this._file),c=this;this._getTagReader(b,{onSuccess:function(d){(new d(b)).setTags(c._tags).read(a)},onError:a.onError})}},{key:"_getFileReader",value:function(){return this._fileReader?this._fileReader:this._findFileReader()}},{key:"_findFileReader",value:function(){for(var b=0;b<a.length;b++)if(a[b].canReadFile(this._file))return a[b];throw Error("No suitable file reader found for ",this._file);}},{key:"_getTagReader",
value:function(a,b){if(this._tagReader){var c=this._tagReader;setTimeout(function(){b.onSuccess(c)},1)}else this._findTagReader(a,b)}},{key:"_findTagReader",value:function(a,b){for(var d=[Number.MAX_VALUE,0],e=0;e<c.length;e++){var f=c[e].getTagIdentifierByteRange();if(f[1]<f[0])throw Error("Invalid range: ",f," from ",c[e]);d[0]=Math.min(f[0],d[0]);d[1]=Math.max(f[1],d[1])}a.loadRange(d,{onSuccess:function(){for(var d=0;d<c.length;d++){var e=c[d].getTagIdentifierByteRange(),e=a.getBytesAt(e[0],e[1]-
e[0]+1);if(c[d].canReadTagFormat(e)){b.onSuccess(c[d]);break}}},onError:b.onError})}}]);return b}(),e=function(){function b(){l(this,b)}g(b,null,[{key:"addFileReader",value:function(b){a.push(b);return this}},{key:"addTagReader",value:function(a){c.push(a);return this}},{key:"removeTagReader",value:function(a){a=c.indexOf(a);0<=a&&c.splice(a,1);return this}}]);return b}();e.addFileReader(d).addTagReader(f);"undefined"!==typeof process&&e.addFileReader(n);m.exports={read:function(a,c){(new b(a)).read(c)},
Reader:b,Config:e}},{"./FlowTypes":4,"./ID3v2TagReader":6,"./MediaFileReader":7,"./MediaTagReader":8,"./NodeFileReader":1,"./XhrFileReader":10}]},{},[11])(11)});
